# 菜单差异可视化工具

一个强大的 Web 应用，用于比对两个环境（如测试环境与生产环境）的菜单按钮 JSON 数据，清晰展示新增、删除、修改的菜单项。

## 🚀 功能特性

### 核心功能

- **智能差异检测**: 自动识别新增、删除、修改的菜单项
- **树形结构展示**: 以层级方式展示菜单及子菜单差异
- **实时搜索过滤**: 支持按菜单标题、名称、路径搜索
- **多格式导出**: 支持 HTML、JSON、CSV 格式的差异报告

### 可视化特性

- **颜色编码**: 绿色（新增）、红色（删除）、蓝色（修改）
- **详细变更信息**: 显示具体变更字段和前后值对比
- **交互操作**: 节点展开/折叠、悬停提示
- **响应式设计**: 支持各种屏幕尺寸

### 数据输入

- **JSON 文本输入**: 直接粘贴 JSON 数据
- **文件上传**: 支持.json 文件上传
- **格式验证**: 实时验证 JSON 格式正确性

## 🛠 技术栈

- **前端框架**: React 18 + TypeScript
- **UI 组件库**: Ant Design 5
- **差异算法**: 自实现深度比较算法
- **样式方案**: CSS + Ant Design 主题

## 📦 安装部署

### 环境要求

- Node.js >= 16
- npm >= 8

### 快速开始

1. **克隆项目**

```bash
git clone <repository-url>
cd menu-diff-visualizer
```

2. **安装依赖**

```bash
npm install
```

3. **启动开发服务器**

```bash
npm start
```

4. **访问应用** 打开浏览器访问 `http://localhost:3000`

### 构建生产版本

```bash
npm run build
```

## 📖 使用指南

### 基本使用流程

1. **准备数据**: 获取两个环境的菜单 JSON 数据
2. **输入数据**: 在左右两个输入框中粘贴或上传 JSON 文件
3. **查看差异**: 系统自动计算并展示差异结果
4. **分析变更**: 查看统计信息和详细的差异树
5. **导出报告**: 选择合适的格式导出差异报告

### 菜单数据格式示例

```json
{
  "id": 1032,
  "name": "equality",
  "menuType": 1,
  "parentId": 0,
  "path": "/equality/*",
  "title": "权益管理",
  "hidden": false,
  "component": "pages/microAppPage/index.tsx",
  "sort": 4,
  "children": [
    {
      "id": 1472,
      "name": "approve",
      "title": "审批中心",
      "path": "/approve",
      "children": []
    }
  ]
}
```

### 差异类型说明

- **🟢 新增**: 存在于菜单 B 但不在菜单 A 中的项目
- **🔴 删除**: 存在于菜单 A 但不在菜单 B 中的项目
- **🔵 修改**: 相同 ID 但属性发生变化的项目
- **⚪ 未变更**: 完全相同的项目（可选显示）

## 🔧 项目结构

```
src/
├── components/          # React组件
│   ├── DiffTree.tsx    # 差异树形组件
│   ├── JsonInput.tsx   # JSON输入组件
│   └── StatisticsPanel.tsx # 统计面板组件
├── types/              # TypeScript类型定义
│   └── menu.ts        # 菜单相关类型
├── utils/              # 工具函数
│   ├── diffCalculator.ts # 差异计算核心算法
│   └── reportGenerator.ts # 报告生成工具
├── App.tsx            # 主应用组件
├── App.css           # 应用样式
└── index.tsx         # 应用入口
```

## 🧪 核心算法

### 差异计算算法

采用基于 ID 映射的深度比较算法：

1. **构建映射表**: 为两个菜单数据构建 ID→ 菜单项的映射
2. **遍历对比**: 遍历所有唯一 ID，逐一比较对应项目
3. **递归处理**: 递归处理子菜单的差异计算
4. **字段比较**: 对同 ID 项目进行逐字段深度比较

### 性能优化

- 使用 Map 数据结构提升查找效率
- 采用递归方式处理嵌套结构
- 实现增量更新避免不必要的重计算

## 📊 报告格式

### HTML 报告

- 包含完整的样式和交互功能
- 适合在线查看和分享
- 支持打印和另存为 PDF

### JSON 报告

```json
{
  "timestamp": "2024-01-01T00:00:00.000Z",
  "statistics": {
    "added": 5,
    "removed": 2,
    "modified": 3,
    "total": 50
  },
  "differences": [...]
}
```

### CSV 报告

适合导入 Excel 进行进一步分析，包含以下字段：

- ID、标题、路径、差异类型、变更字段、旧值、新值

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。
